enum Platform {
    WEB, IOS, ANDROID
}

type OnlineEvent {
    userId: ID!
    timeout: Int!
    online: Boolean!
    active: Boolean!
    lastSeen: String!

    # Deprecated
    type: String!
    user: User!
}

type ChatOnlineEvent {
    onlineMembers: Int!
}

type IsAppInstalledResponse {
    installed: Boolean!
    installedAt: Date
}

extend type Mutation {
    presenceReportOnline(timeout: Int!, platform: String, active: Boolean): String!
    presenceReportOffline(platform: Platform): String! @withAuth
    
    alphaReportActive(timeout: Int!, platform: Platform): String!

    alphaSetDesktopInstalled(at: Date!): Boolean!
    alphaSetMobileInstalled(at: Date!): Boolean!
}

extend type Query {
    isDesktopInstalled: IsAppInstalledResponse!
    isMobileInstalled: IsAppInstalledResponse!
}

extend type Subscription {
    alphaSubscribeChatOnline(conversations: [ID!]!): OnlineEvent!
    alphaSubscribeOnline(users: [ID!]!): OnlineEvent!

    chatOnlinesCount(chatId: ID!): ChatOnlineEvent!
}