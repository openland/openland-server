type ConversationUpdateSingle {
    seq: Int!
    state: String!
    update: ConversationUpdate!
}

type ConversationUpdateBatch {
    updates: [ConversationUpdate!]!
    fromSeq: Int!
    seq: Int!
    state: String!
}

union ConversationUpdateContainer = ConversationUpdateSingle | ConversationUpdateBatch

union ConversationUpdate = ConversationMessageReceived | ConversationMessageUpdated | ConversationMessageDeleted 

type ConversationMessageReceived {
    message: ConversationMessage!
}

type ConversationMessageUpdated {
    message: ConversationMessage!
}

type ConversationMessageDeleted {
    message: ConversationMessage!
}

type ConversationUpdateState {
    state: String
}

extend type Query {
    conversationState(id: ID!): ConversationUpdateState!
}

extend type Subscription {
    conversationUpdates(conversationId: ID!, fromState: String): ConversationUpdateContainer!
}