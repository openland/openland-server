type DialogUpdateSingle {
    seq: Int!
    state: String!
    update: DialogUpdate!
}

type DialogUpdateBatch {
    updates: [DialogUpdate!]!
    fromSeq: Int!
    seq: Int!
    state: String!
}

union DialogUpdateContainer = DialogUpdateSingle | DialogUpdateBatch

union DialogUpdate = DialogMessageReceived | DialogMessageUpdated | DialogMessageDeleted | DialogMessageRead | DialogTitleUpdated | DialogDeleted | DialogPhotoUpdated | DialogMuteChanged | DialogMentionedChanged | DialogBump

type SilentMessageInfo {
    mobile: Boolean!
    desktop: Boolean!
}

type DialogMessageReceived {
    cid: ID!
    message: ConversationMessage!
    betaMessage: RoomMessage!
    alphaMessage: ModernMessage!
    unread: Int!
    globalUnread: Int!
    haveMention: Boolean!
    silent: SilentMessageInfo!
}

type DialogMessageUpdated {
    cid: ID!
    message: ConversationMessage!
    betaMessage: RoomMessage!
    alphaMessage: ModernMessage!
    haveMention: Boolean!
}

type DialogMessageDeleted {
    cid: ID!
    message: ConversationMessage!
    betaMessage: RoomMessage!
    prevMessage: RoomMessage
    alphaPrevMessage: ModernMessage
    alphaMessage: ModernMessage!
    unread: Int!
    globalUnread: Int!
    haveMention: Boolean!
}

type DialogMessageRead {
    cid: ID!
    unread: Int!
    globalUnread: Int!
    haveMention: Boolean!
}

type DialogTitleUpdated {
    cid: ID!
    title: String!
}

type DialogPhotoUpdated {
    cid: ID!
    photo: String
}

type DialogDeleted {
    cid: ID!
    globalUnread: Int!
}

type DialogBump {
    cid: ID!
    globalUnread: Int!
    unread: Int!
    topMessage: ModernMessage
    haveMention: Boolean!
}

type DialogMuteChanged {
    cid: ID!
    mute: Boolean!
    globalUnread: Int!
}

# depricated
type DialogMentionedChanged {
    cid: ID!
    haveMention: Boolean!
}

type DialogUpdateState {
    state: String
}

extend type Query {
    dialogsState: DialogUpdateState!
}

extend type Subscription {
    dialogsUpdates(fromState: String): DialogUpdateContainer!
}
